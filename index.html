<html>
<head>
	<title>MCEdit</title>
	<script src="js/jquery-2.1.1.min.js"></script>
	<script>
		/*versionCompare from http://stackoverflow.com/a/6832721*/
		function compareVersionString(v1, v2, options) {
			var lexicographical = options && options.lexicographical,
			zeroExtend = options && options.zeroExtend,
			v1parts = v1.split('.'),
			v2parts = v2.split('.');

			function isValidPart(x) {
				return (lexicographical ? /^\d+[A-Za-z]*$/ : /^\d+$/).test(x);
			}

			if (!v1parts.every(isValidPart) || !v2parts.every(isValidPart)) {
				return NaN;
			}

			if (zeroExtend) {
				while (v1parts.length < v2parts.length) v1parts.push("0");
				while (v2parts.length < v1parts.length) v2parts.push("0");
			}

			if (!lexicographical) {
				v1parts = v1parts.map(Number);
				v2parts = v2parts.map(Number);
			}

			for (var i = 0; i < v1parts.length; ++i) {
				if (v2parts.length == i) {
					return 1;
				}

				if (v1parts[i] == v2parts[i]) {
					continue;
				}
				else if (v1parts[i] > v2parts[i]) {
					return 1;
				}
				else {
					return -1;
				}
			}

			if (v1parts.length != v2parts.length) {
				return -1;
			}

			return 0;
		}
		function compareVersionObject(a,b) {
			return compareVersionString(a.tag_name, b.tag_name) * -1;
		}
		function createReleaseNotes(data) {
			try {
				if (data.length == 0) {
					releaseNotesFail();
					return false;
				}

				prereleases = [];
				releases = [];
				for (var i = 0; i < data.length; i++) {
					if (data[i].prerelease) {
						prereleases.push(data[i]);
					} else {
						releases.push(data[i]);
					}
				}
				releases.sort(compareVersionObject);
				prereleases.sort(compareVersionObject);

				if (releases.length > 0) {
					release = releases[0];
					$('#releaseversion').html(release.tag_name);
					for (var i = 0; i < release.assets.length; i++) {
						$('#release-downloads').append('<a href="' + release.assets[i].browser_download_url + '"><i class="fa fa-cloud-download"></i> ' + release.assets[i].name + '</a><br>');
					}
					$('#release-notes').html('<a href="' + release.html_url + '"><i class="fa fa-book"></i> Release notes</a>');
					$('#release-message').slideDown();
				}
				if (prereleases.length > 0) {
					prerelease = prereleases[0];
					$('#prereleaseversion').html(prerelease.tag_name);
					for (var i = 0; i < prerelease.assets.length; i++) {
						$('#prerelease-downloads').append('<a href="' + prerelease.assets[i].browser_download_url + '"><i class="fa fa-cloud-download"></i> ' + prerelease.assets[i].name + '</a><br>');
					}
					$('#prerelease-notes').html('<a href="' + prerelease.html_url + '"><i class="fa fa-book"></i> Release notes</a>');
					$('#prerelease-message').slideDown();
				}
			} catch(err) {
				releaseNotesFail();
			}
			$('#loading-message').slideUp();
		}
		function releaseNotesFail() {
			$('#failed-message').slideDown();
			$('#loading-message').slideUp();
		}
		$(document).ready(function(){
			$.get('https://api.github.com/repos/Khroki/MCEdit-Unified/releases').done(createReleaseNotes).fail(releaseNotesFail);
		});
	</script>
	<link rel="stylesheet" type="text/css" href="css/min.css">
	<link rel="stylesheet" href="css/font-awesome.min.css">
	<style>
		a {
			color: #4484C2;
		}
		#prerelease-message {
			background:#FDC192;
			border-color:#FD9840;
		}
		#failed-message {
			background:#D87477;
			border-color:#C7393D;
		}
		#prerelease-message a {
			color: DodgerBlue;
			text-decoration: none;
		}
		#failed-message a {
			color: DodgerBlue;
		}
		#msg a {
			text-decoration: none;
		}
		#msg a:hover {
			text-decoration: underline;
		}
	</style>
</head>
<body>
	<nav class="nav" tabindex="-1" onclick="this.focus()">
		<div class="container">
			<a class="pagename current" href="index.html">MCEdit</a>
			<a href="about/index.html">About</a>
			<a href="https://github.com/Khroki/MCEdit-Unified/releases">Releases</a>
		</div>
	</nav>
	<div class="container">
		<div class="msg" id="loading-message">
			<strong><i class="fa fa-spin fa-refresh"></i> Loading release information</strong>
		</div>
		<div class="msg" id="failed-message" style="display:none;">
			<strong><i class="fa fa-times"></i> Couldn't load release information</strong>
		</div>
		<div class="msg" style="display:none;" id="prerelease-message">
			<strong>Pre-Release version <span id="prereleaseversion">null</span></strong>
			<br>
			<span id="prerelease-notes"></span>
			<br>
			<span id="prerelease-downloads"></span>
		</div>
		<div class="msg" style="display:none;" id="release-message">
			<strong>Release version <span id="releaseversion">null</span></strong>
			<br>
			<span id="release-notes"></span>
			<br>
			<span id="release-downloads"></span>
		</div>
		<div class="copyright" style="position:absolute;bottom:0px;color:gray;padding:4px;">
			&copy; 2010 David Rio Vierra
		</div>
	</div>
</body>
</html>